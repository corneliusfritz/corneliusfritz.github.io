<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="The function bigergm estimates and simulates three classes of exponential-family
random graph models for large networks under local dependence:
The p_1 model of Holland and Leinhardt (1981) in exponential-family form and extensions by Vu, Hunter, and Schweinberger (2013), Schweinberger, Petrescu-Prahova, and Vu (2014), Dahbura et al. (2021), and Fritz et al. (2024) to both directed and undirected random graphs with additional model terms, with and without covariates.
The stochastic block model of Snijders and Nowicki (1997) and Nowicki and Snijders (2001) in exponential-family form.
The exponential-family random graph models with local dependence of Schweinberger and Handcock (2015), with and without covariates. The exponential-family random graph models with local dependence replace the long-range dependence of conventional exponential-family random graph models by short-range dependence. Therefore, exponential-family random graph models with local dependence replace the strong dependence of conventional exponential-family random graph models by weak dependence, reducing the problem of model degeneracy (Handcock, 2003; Schweinberger, 2011) and improving goodness-of-fit (Schweinberger and Handcock, 2015). In addition, exponential-family random graph models with local dependence satisfy a weak form of self-consistency in the sense that these models are self-consistent under neighborhood sampling (Schweinberger and Handcock, 2015), which enables consistent estimation of neighborhood-dependent parameters (Schweinberger and Stewart, 2017; Schweinberger, 2017).

"><title>bigergm: Exponential-family random graph models for large networks with local dependence — bigergm • bigergm</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.11/clipboard.min.js" integrity="sha512-7O5pXpc0oCRrxk8RUfDYFgn0nO1t+jLuIOQdOMRp4APB7uZ4vSjspzp5y6YDtDs4VzUSTbWzBFZ/LKJhnyFOKw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="bigergm: Exponential-family random graph models for large networks with local dependence — bigergm"><meta property="og:description" content="The function bigergm estimates and simulates three classes of exponential-family
random graph models for large networks under local dependence:
The p_1 model of Holland and Leinhardt (1981) in exponential-family form and extensions by Vu, Hunter, and Schweinberger (2013), Schweinberger, Petrescu-Prahova, and Vu (2014), Dahbura et al. (2021), and Fritz et al. (2024) to both directed and undirected random graphs with additional model terms, with and without covariates.
The stochastic block model of Snijders and Nowicki (1997) and Nowicki and Snijders (2001) in exponential-family form.
The exponential-family random graph models with local dependence of Schweinberger and Handcock (2015), with and without covariates. The exponential-family random graph models with local dependence replace the long-range dependence of conventional exponential-family random graph models by short-range dependence. Therefore, exponential-family random graph models with local dependence replace the strong dependence of conventional exponential-family random graph models by weak dependence, reducing the problem of model degeneracy (Handcock, 2003; Schweinberger, 2011) and improving goodness-of-fit (Schweinberger and Handcock, 2015). In addition, exponential-family random graph models with local dependence satisfy a weak form of self-consistency in the sense that these models are self-consistent under neighborhood sampling (Schweinberger and Handcock, 2015), which enables consistent estimation of neighborhood-dependent parameters (Schweinberger and Stewart, 2017; Schweinberger, 2017).

"><meta property="og:image" content="/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light" data-bs-theme="light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">bigergm</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.2.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item">
  <a class="nav-link" href="../articles/bigergm.html">Get started</a>
</li>
<li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"></ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>bigergm: Exponential-family random graph models for large networks with local dependence</h1>
      
      <div class="d-none name"><code>bigergm.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>The function <code>bigergm</code> estimates and simulates three classes of exponential-family
random graph models for large networks under local dependence:</p><ol><li><p>The p_1 model of Holland and Leinhardt (1981) in exponential-family form and extensions by Vu, Hunter, and Schweinberger (2013), Schweinberger, Petrescu-Prahova, and Vu (2014), Dahbura et al. (2021), and Fritz et al. (2024) to both directed and undirected random graphs with additional model terms, with and without covariates.</p></li>
<li><p>The stochastic block model of Snijders and Nowicki (1997) and Nowicki and Snijders (2001) in exponential-family form.</p></li>
<li><p>The exponential-family random graph models with local dependence of Schweinberger and Handcock (2015), with and without covariates. The exponential-family random graph models with local dependence replace the long-range dependence of conventional exponential-family random graph models by short-range dependence. Therefore, exponential-family random graph models with local dependence replace the strong dependence of conventional exponential-family random graph models by weak dependence, reducing the problem of model degeneracy (Handcock, 2003; Schweinberger, 2011) and improving goodness-of-fit (Schweinberger and Handcock, 2015). In addition, exponential-family random graph models with local dependence satisfy a weak form of self-consistency in the sense that these models are self-consistent under neighborhood sampling (Schweinberger and Handcock, 2015), which enables consistent estimation of neighborhood-dependent parameters (Schweinberger and Stewart, 2017; Schweinberger, 2017).</p></li>
</ol></div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">bigergm</span><span class="op">(</span></span>
<span>  <span class="va">object</span>,</span>
<span>  add_intercepts <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  n_blocks <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  n_cores <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  blocks <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  estimate_parameters <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  verbose <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  n_MM_step_max <span class="op">=</span> <span class="fl">100</span>,</span>
<span>  tol_MM_step <span class="op">=</span> <span class="fl">1e-04</span>,</span>
<span>  initialization <span class="op">=</span> <span class="st">"infomap"</span>,</span>
<span>  use_infomap_python <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  virtualenv_python <span class="op">=</span> <span class="st">"r-bigergm"</span>,</span>
<span>  seed_infomap <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  weight_for_initialization <span class="op">=</span> <span class="fl">1000</span>,</span>
<span>  seed <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  method_within <span class="op">=</span> <span class="st">"MPLE"</span>,</span>
<span>  control_within <span class="op">=</span> <span class="fu">ergm</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ergm/man/control.ergm.html" class="external-link">control.ergm</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  clustering_with_features <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  compute_pi <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  check_alpha_update <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  check_blocks <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  cache <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  return_checkpoint <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  only_use_preprocessed <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>object</dt>
<dd><p>An <span style="R">R</span> <code><a href="https://rdrr.io/r/stats/formula.html" class="external-link">formula</a></code> object or <code>bigergm</code> class object.
If a formula is given, the function estimates a new model specified by it.
It needs to be of the form
<code>y ~ &lt;model terms&gt;</code>, where <code>y</code> is a
<code><a href="https://rdrr.io/pkg/network/man/network.html" class="external-link">network</a></code> object.
For the details on the possible <code>&lt;model terms&gt;</code>, see
<code><a href="https://rdrr.io/pkg/ergm/man/ergmTerm.html" class="external-link">ergmTerm</a></code> and Morris, Handcock and Hunter (2008).
All terms that induce dependence are excluded from the between block model, while the within block model includes all terms.
When you pass a <code>bigergm</code> class object to the function, you continue from the previous MM step.
Note that the block allocation (which is either provided by parameter <code>blocks</code> or estimated in the first step) is saved as the vertex.attribute <code>block</code> of the network.
This attribute can also be used in the specified formula.
The <code><a href="https://rdrr.io/pkg/ergm.multi/man/L-ergmTerm-719c792f.html" class="external-link">L-ergmTerm</a></code> is supported to enable size-dependent coefficients for the within-blocks model.
Note, however, that for size-dependent parameters of terms that are included in the between-blocks model,
the intercept in the linear model provided to <code><a href="https://rdrr.io/pkg/ergm.multi/man/L-ergmTerm-719c792f.html" class="external-link">L-ergmTerm</a></code> should not include the intercept.
See the second example below for a demonstration.</p></dd>


<dt>add_intercepts</dt>
<dd><p>Boolean value to indicate whether adequate intercepts
should be added to the provided formula so that the model in the first stage
of the estimation is a nested model of the estimated model in the second stage of the estimation.</p></dd>


<dt>n_blocks</dt>
<dd><p>The number of blocks. This must be specified by the user.
When you pass a <code>bigergm</code> class object to the function, you don't have to specify this argument.</p></dd>


<dt>n_cores</dt>
<dd><p>The number of CPU cores to use.</p></dd>


<dt>blocks</dt>
<dd><p>The pre-specified block memberships for each node.
If <code>NULL</code>, the latent community structure is estimated, assuming that the number of communities is <code>n_blocks</code>.</p></dd>


<dt>estimate_parameters</dt>
<dd><p>If <code>TRUE</code>, both clustering and parameter estimation are implemented.
If <code>FALSE</code>, only clustering is executed.</p></dd>


<dt>verbose</dt>
<dd><p>A logical or an integer: if this is TRUE/1,
the program will print out additional information about the progress of estimation and simulation.
A higher value yields lower level information.</p></dd>


<dt>n_MM_step_max</dt>
<dd><p>The maximum number of MM iterations.
Currently, no early stopping criteria is introduced. Thus <code>n_MM_step_max</code> MM iterations are exactly implemented.</p></dd>


<dt>tol_MM_step</dt>
<dd><p>Tolerance regarding the relative change of the lower bound of the likelihood
used to decide on the convergence of the clustering step</p></dd>


<dt>initialization</dt>
<dd><p>How the blocks should be initialized.
If <code>infomap</code> (the default), <code>igraph</code>' or Python's infomap is implemented.
If <code>random</code>, the initial clusters are randomly uniformally selected.
If <code>spectral</code>, spectral clustering is conducted.
If <code>walktrap</code>, the walktrap clustering algorithm as implemented in <code><a href="https://r.igraph.org/reference/cluster_walktrap.html" class="external-link">cluster_walktrap</a></code> is conducted.
If <code>initialization</code>
is a vector of integers of the same length as the number of nodes in the provided network (in <code>object</code>),
then the provided vector is used as the initial cluster assignment.
If <code>initialization</code> is a string relating to a file path, <code>bigergm</code> will interpret it as block allocations saved in Python's infomap .clu format under that path.</p></dd>


<dt>use_infomap_python</dt>
<dd><p>If <code>TRUE</code>, the cluster initialization is implemented using Pythons' infomap.</p></dd>


<dt>virtualenv_python</dt>
<dd><p>Which virtual environment should be used for the infomap algorithm?</p></dd>


<dt>seed_infomap</dt>
<dd><p>seed value (integer) for the infomap algorithm, which can be used to initialize the estimation of the blocks.</p></dd>


<dt>weight_for_initialization</dt>
<dd><p>weight value used for cluster initialization. The higher this value, the more weight is put on the initialized block allocation.</p></dd>


<dt>seed</dt>
<dd><p>seed value (integer) for the random number generator.</p></dd>


<dt>method_within</dt>
<dd><p>If "MPLE" (the default), then the maximum pseudolikelihood estimator is implemented when estimating the within-block network model.
If "MLE", then an approximate maximum likelihood estimator is conducted. If "CD" (EXPERIMENTAL), the Monte-Carlo contrastive divergence estimate is returned.</p></dd>


<dt>control_within</dt>
<dd><p>A list of control parameters for the <code><a href="https://rdrr.io/pkg/ergm/man/ergm.html" class="external-link">ergm</a></code> function used to estimate the parameters of the within model. See <code><a href="https://rdrr.io/pkg/ergm/man/control.ergm.html" class="external-link">control.ergm</a></code> for details.</p></dd>


<dt>clustering_with_features</dt>
<dd><p>If <code>TRUE</code>, clustering is implemented using the discrete covariates specified in the formula.</p></dd>


<dt>compute_pi</dt>
<dd><p>If <code>TRUE</code>, this function keeps track of pi matrices at each MM iteration.
If the network is large, we strongly recommend to set to be <code>FALSE</code>.</p></dd>


<dt>check_alpha_update</dt>
<dd><p>If <code>TRUE</code>, this function keeps track of alpha matrices at each MM iteration.
If the network is large, we strongly recommend to set to be <code>FALSE</code>.</p></dd>


<dt>check_blocks</dt>
<dd><p>If TRUE, this function keeps track of estimated block memberships at each MM iteration.</p></dd>


<dt>cache</dt>
<dd><p>a <code>cachem</code> cache object used to store intermediate calculations such as eigenvector decomposition results.</p></dd>


<dt>return_checkpoint</dt>
<dd><p>If <code>TRUE</code>, the function returns the checkpoint list. For most applications, this should be set to <code>TRUE</code> but if memory space needed by the output is an issue, set to <code>FALSE</code>.</p></dd>


<dt>only_use_preprocessed</dt>
<dd><p>If <code>TRUE</code>, the function only uses the preprocessed data from a previous fit but does not continue the estimation from its final iteration, instead the estimation is started again from the provided initialization.</p></dd>


<dt>...</dt>
<dd><p>Additional arguments, to be passed to lower-level functions (mainly to the <code><a href="https://rdrr.io/pkg/ergm/man/ergm.html" class="external-link">ergm</a></code> function used for the estimation of within-block connections).</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>An object of class 'bigergm' including the results of the fitted model.
These include:</p><dl><dt>call:</dt>
<dd><p>call of the mode</p></dd>

<dt>block:</dt>
<dd><p>vector of the found block of the nodes into cluster</p></dd>

<dt>initial_block:</dt>
<dd><p>vector of the initial block of the nodes into cluster</p></dd>

<dt>sbm_pi:</dt>
<dd><p>Connection probabilities represented as a <code>n_blocks x n_blocks</code> matrix from the first stage of the estimation between all clusters</p></dd>

<dt>MM_list_z:</dt>
<dd><p>list of cluster allocation for each node and each iteration</p></dd>

<dt>MM_list_alpha:</dt>
<dd><p>list of posterior distributions of cluster allocations for all nodes for each iteration</p></dd>

<dt>MM_change_in_alpha:</dt>
<dd><p>change in 'alpha' for each iteration</p></dd>

<dt>MM_lower_bound:</dt>
<dd><p>vector of the evidence lower bounds from the MM algorithm</p></dd>

<dt>alpha: </dt>
<dd><p>matrix representing the converged posterior distributions of cluster allocations for all nodes</p></dd>

<dt>counter_e_step:</dt>
<dd><p>integer number indicating the number of iterations carried out</p></dd>

<dt>adjacency_matrix:</dt>
<dd><p>sparse matrix representing the adjacency matrix used for the estimation</p></dd>

<dt>estimation_status:</dt>
<dd><p>character stating the status of the estimation</p></dd>

<dt>est_within:</dt>
<dd><p><code><a href="https://rdrr.io/pkg/ergm/man/ergm.html" class="external-link">ergm</a></code> object of the model for within cluster connections</p></dd>

<dt>est_between:</dt>
<dd><p><code><a href="https://rdrr.io/pkg/ergm/man/ergm.html" class="external-link">ergm</a></code> object of the model for between cluster connections</p></dd>

<dt>checkpoint:</dt>
<dd><p>list of information to continue the estimation (only returned if <code>return_checkpoint = TRUE</code>)</p></dd>

<dt>membership_before_kmeans:</dt>
<dd><p>vector of the found blocks of the nodes into cluster before the final check for bad clusters</p></dd>

<dt>estimate_parameters:</dt>
<dd><p>binary value if the parameters in the second step of the algorithm should be estimated or not</p></dd>


</dl></div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Babkin, S., Stewart, J., Long, X., and M. Schweinberger (2020). Large-scale estimation of random graph models with local dependence. Computational Statistics and Data Analysis, 152, 1--19.</p>
<p>Dahbura, J. N. M., Komatsu, S., Nishida, T. and Mele, A. (2021), ‘A structural model of business cards exchange networks’.
https://arxiv.org/abs/2105.12704</p>
<p>Fritz C., Georg C., Mele A., and Schweinberger M. (2024). A strategic model of software dependency networks.
https://arxiv.org/abs/2402.13375</p>
<p>Handcock, M. S. (2003). Assessing degeneracy in statistical models of social networks. Technical report, Center for Statistics and the Social Sciences, University of Washington, Seattle. <br>
https://csss.uw.edu/Papers/wp39.pdf</p>
<p>Holland, P. W. and S. Leinhardt (1981). An exponential family of probability distributions for directed graphs. Journal of the American Statistical Association, Theory &amp; Methods, 76, 33--65.</p>
<p>Morris M, Handcock MS, Hunter DR (2008). Specification of Exponential-Family Random Graph Models: Terms and Computational Aspects.
Journal of Statistical Software, 24.</p>
<p>Nowicki, K. and T. A. B. Snijders (2001). Estimation and prediction for stochastic blockstructures. Journal of the American Statistical Association, Theory &amp; Methods, 96, 1077--1087.</p>
<p>Schweinberger, M. (2011). Instability, sensitivity, and degeneracy of discrete exponential families. Journal of the American Statistical Association, Theory &amp; Methods, 106, 1361--1370.</p>
<p>Schweinberger, M. (2020). Consistent structure estimation of exponential-family random graph models with block structure. Bernoulli, 26, 1205--1233.</p>
<p>Schweinberger, M. and M. S. Handcock (2015). Local dependence in random graph models: characterization, properties, and statistical inference. Journal of the Royal Statistical Society, Series B (Statistical Methodology), 7, 647-676.</p>
<p>Schweinberger, M., Krivitsky, P. N., Butts, C.T. and J. Stewart (2020). Exponential-family models of random graphs: Inference in finite, super, and infinite population scenarios. Statistical Science, 35, 627-662.</p>
<p>Schweinberger, M. and P. Luna (2018). HERGM: Hierarchical exponential-family random graph models. Journal of Statistical Software, 85, 1--39.</p>
<p>Schweinberger, M., Petrescu-Prahova, M. and D. Q. Vu (2014). Disaster response on September 11, 2001 through the lens of statistical network analysis. Social Networks, 37, 42--55.</p>
<p>Schweinberger, M. and J. Stewart (2020). Concentration and consistency results for canonical and curved exponential-family random graphs. The Annals of Statistics, 48, 374--396.</p>
<p>Snijders, T. A. B. and K. Nowicki (1997). Estimation and prediction for stochastic blockmodels for graphs with latent block structure. Journal of Classification, 14, 75--100.</p>
<p>Stewart, J., Schweinberger, M., Bojanowski, M., and M. Morris (2019). Multilevel network data facilitate statistical inference for curved ERGMs with geometrically weighted terms. Social Networks, 59, 98--119.</p>
<p>Vu, D. Q., Hunter, D. R. and M. Schweinberger (2013). Model-based clustering of large networks. Annals of Applied Statistics, 7, 1010--1039.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># Load an embedded network object.</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">toyNet</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Specify the model that you would like to estimate.</span></span></span>
<span class="r-in"><span><span class="va">model_formula</span> <span class="op">&lt;-</span> <span class="va">toyNet</span> <span class="op">~</span> <span class="va">edges</span> <span class="op">+</span> <span class="fu">nodematch</span><span class="op">(</span><span class="st">"x"</span><span class="op">)</span> <span class="op">+</span> <span class="fu">nodematch</span><span class="op">(</span><span class="st">"y"</span><span class="op">)</span> <span class="op">+</span> <span class="va">triangle</span></span></span>
<span class="r-in"><span><span class="co"># Estimate the model</span></span></span>
<span class="r-in"><span><span class="va">bigergm_res</span> <span class="op">&lt;-</span> <span class="fu">bigergm</span><span class="op">(</span></span></span>
<span class="r-in"><span>  object <span class="op">=</span> <span class="va">model_formula</span>,</span></span>
<span class="r-in"><span>  <span class="co"># The model you would like to estimate</span></span></span>
<span class="r-in"><span>  n_blocks <span class="op">=</span> <span class="fl">4</span>,</span></span>
<span class="r-in"><span>  <span class="co"># The number of blocks</span></span></span>
<span class="r-in"><span>  n_MM_step_max <span class="op">=</span> <span class="fl">10</span>,</span></span>
<span class="r-in"><span>  <span class="co"># The maximum number of MM algorithm steps</span></span></span>
<span class="r-in"><span>  estimate_parameters <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>  <span class="co"># Perform parameter estimation after the block recovery step</span></span></span>
<span class="r-in"><span>  clustering_with_features <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>  <span class="co"># Indicate that clustering must take into account nodematch on characteristics</span></span></span>
<span class="r-in"><span>  check_blocks <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span>  </span></span>
<span class="r-in"><span> <span class="co"># Example with N() operator</span></span></span>
<span class="r-in"><span> </span></span>
<span class="r-in"><span> <span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># Prepare ingredients for simulating a network</span></span></span>
<span class="r-in"><span><span class="va">N</span> <span class="op">&lt;-</span> <span class="fl">500</span></span></span>
<span class="r-in"><span><span class="va">K</span> <span class="op">&lt;-</span> <span class="fl">10</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">list_within_params</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">2</span>,<span class="op">-</span><span class="fl">0.5</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">list_between_params</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">8</span>, <span class="fl">0.5</span>, <span class="op">-</span><span class="fl">0.5</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">formula</span> <span class="op">&lt;-</span> <span class="va">g</span> <span class="op">~</span> <span class="va">edges</span> <span class="op">+</span> <span class="fu">nodematch</span><span class="op">(</span><span class="st">"x"</span><span class="op">)</span> <span class="op">+</span> <span class="fu">nodematch</span><span class="op">(</span><span class="st">"y"</span><span class="op">)</span>  <span class="op">+</span> <span class="fu">N</span><span class="op">(</span><span class="op">~</span><span class="va">edges</span>,<span class="op">~</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">memb</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="va">K</span>,prob <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.1</span>,<span class="fl">0.2</span>,<span class="fl">0.05</span>,<span class="fl">0.05</span>,<span class="fl">0.10</span>,<span class="fl">0.1</span>,<span class="fl">0.1</span>,<span class="fl">0.1</span>,<span class="fl">0.1</span>,<span class="fl">0.1</span><span class="op">)</span>, </span></span>
<span class="r-in"><span>               size <span class="op">=</span> <span class="va">N</span>, replace <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">vertex_id</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="fl">11</span><span class="op">:</span><span class="op">(</span><span class="fl">11</span> <span class="op">+</span> <span class="va">N</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span>, size <span class="op">=</span> <span class="va">N</span>, replace <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span>, size <span class="op">=</span> <span class="va">N</span>, replace <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  id <span class="op">=</span> <span class="va">vertex_id</span>,</span></span>
<span class="r-in"><span>  memb <span class="op">=</span> <span class="va">memb</span>,</span></span>
<span class="r-in"><span>  x <span class="op">=</span> <span class="va">x</span>,</span></span>
<span class="r-in"><span>  y <span class="op">=</span> <span class="va">y</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">g</span> <span class="op">&lt;-</span> <span class="fu">network</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/network/man/network.initialize.html" class="external-link">network.initialize</a></span><span class="op">(</span>n <span class="op">=</span> <span class="va">N</span>, directed <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">g</span> <span class="op">%v%</span> <span class="st">"vertex.names"</span> <span class="op">&lt;-</span> <span class="va">df</span><span class="op">$</span><span class="va">id</span></span></span>
<span class="r-in"><span><span class="va">g</span> <span class="op">%v%</span> <span class="st">"block"</span> <span class="op">&lt;-</span> <span class="va">df</span><span class="op">$</span><span class="va">memb</span></span></span>
<span class="r-in"><span><span class="va">g</span> <span class="op">%v%</span> <span class="st">"x"</span> <span class="op">&lt;-</span> <span class="va">df</span><span class="op">$</span><span class="va">x</span></span></span>
<span class="r-in"><span><span class="va">g</span> <span class="op">%v%</span> <span class="st">"y"</span> <span class="op">&lt;-</span> <span class="va">df</span><span class="op">$</span><span class="va">y</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Simulate a network</span></span></span>
<span class="r-in"><span><span class="va">g_sim</span> <span class="op">&lt;-</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="simulate_bigergm.html">simulate_bigergm</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    formula <span class="op">=</span> <span class="va">formula</span>,</span></span>
<span class="r-in"><span>    coef_within <span class="op">=</span> <span class="va">list_within_params</span>,</span></span>
<span class="r-in"><span>    coef_between <span class="op">=</span> <span class="va">list_between_params</span>,</span></span>
<span class="r-in"><span>    nsim <span class="op">=</span> <span class="fl">1</span>, </span></span>
<span class="r-in"><span>    control_within <span class="op">=</span> <span class="fu">control.simulate.formula</span><span class="op">(</span>MCMC.burnin <span class="op">=</span> <span class="fl">200000</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">estimation</span> <span class="op">&lt;-</span> <span class="fu">bigergm</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/update.html" class="external-link">update</a></span><span class="op">(</span><span class="va">formula</span>,new <span class="op">=</span> <span class="va">g_sim</span><span class="op">~</span><span class="va">.</span><span class="op">)</span>, n_blocks <span class="op">=</span> <span class="fl">10</span>, </span></span>
<span class="r-in"><span>                      verbose <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">estimation</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Shota Komatsu, Juan Nelson Martínez Dahbura, Takanori Nishida, Angelo Mele, Cornelius Fritz, Michael Schweinberger.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

    </footer></div>

  

  

  </body></html>

